<!doctype html>
<html lang="en">

<head>
  <title>Cloud Terminal</title>
  <meta charset="UTF-8">
  <meta name="description" content="Cloud-backed terminal interface">
  <meta name="theme-color" content="#0a0a0a">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <!-- Stylesheets -->
  <link rel="stylesheet" href="css/main.min.css" />

  <!-- Google Web fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    * { box-sizing: border-box; }
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background: #0a0a0a;
      color: #e0f7ff;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      overflow: hidden;
    }
    .terminal-container {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 1rem;
    }
    .terminal-box {
      width: 100%;
      max-width: 900px;
      border-radius: 8px;
      box-shadow: 0 0 20px rgba(0,195,255,0.5);
      background-color: #111;
      overflow: hidden;
    }
    .terminal-header {
      background-color: #222;
      padding: 10px 16px;
      color: #ccc;
      font-family: monospace;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid #333;
    }
    .terminal-header .user { color: #4caf50; }
    .terminal-header .path { opacity: 0.6; }
    .terminal-dots {
      display: flex;
      gap: 6px;
    }
    .terminal-dots span {
      height: 12px;
      width: 12px;
      border-radius: 50%;
    }
    .terminal-dots .red { background: #ff5f56; }
    .terminal-dots .yellow { background: #ffbd2e; }
    .terminal-dots .green { background: #27c93f; }
    #terminal {
      padding: 1rem;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 0.95rem;
      max-height: 70vh;
      overflow-y: auto;
      background: #0d0d0d;
    }
    #terminal-content div {
      margin-bottom: 0.5rem;
    }
    .terminal-input-row {
      display: flex;
      align-items: baseline;
      position: relative;
      margin-top: 0.5rem;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 0.95rem;
      line-height: 1.4;
    }
    #terminal-prompt {
      color: #4caf50;
      margin-right: 8px;
      white-space: nowrap;
    }
    #typedContainer {
      display: inline;
      white-space: nowrap;
    }
    #typedText {
      color: #e0f7ff;
      display: inline;
    }
    .blinking-cursor {
      color: #00c3ff;
      display: inline;
      animation: blink 1s step-end infinite;
    }
    @keyframes blink {
      50% { opacity: 0; }
    }
    #terminal-input {
      opacity: 0;
      position: absolute;
      z-index: 9999;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: none;
      border: none;
    }
    #terminal-suggestion {
      color: #555;
      font-style: italic;
      margin-left: 4px;
    }
    #terminal::-webkit-scrollbar { width: 10px; }
    #terminal::-webkit-scrollbar-track { background: #0a0a0a; }
    #terminal::-webkit-scrollbar-thumb {
      background: linear-gradient(90deg, #00ffff 30%, #00bfff 100%);
      box-shadow: 0 0 8px #00eaff, 0 0 16px #00ffff;
      border-radius: 6px;
    }
    pre { white-space: pre-wrap; overflow-x: auto; color: #33ff33; margin: 0; }
    a { color: #00ffff; text-decoration: none; }
    a:hover { text-shadow: 0 0 6px #00eaff; }

    /* Matrix background */
    #matrixRain {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      opacity: 0.15;
    }
  </style>
</head>

<body>
  <canvas id="matrixRain"></canvas>

  <div class="terminal-container">
    <div class="terminal-box">
      <div class="terminal-header">
        <div>
          <span class="user">jinno@terminal</span><span class="path">:~$</span>
        </div>
        <div class="terminal-dots">
          <span class="red"></span>
          <span class="yellow"></span>
          <span class="green"></span>
        </div>
      </div>
      <div id="terminal">
        <div id="terminal-content"></div>
        <div id="terminal-suggestion" style="display:none;"></div>
        <div class="terminal-input-row">
          <span id="terminal-prompt">jinno@terminal:~$</span>
          <span id="typedContainer">
            <span id="typedText"></span>
            <span class="blinking-cursor">▉</span>
          </span>
          <input id="terminal-input" type="text" autocomplete="off" spellcheck="false" autofocus />
        </div>
      </div>
    </div>
  </div>

  <script>
  // Matrix rain background
  const canvas = document.getElementById("matrixRain");
  const ctx = canvas.getContext("2d");

  function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  resizeCanvas();
  window.addEventListener("resize", resizeCanvas);

  const fontSize = 18;
  let columns = Math.floor(canvas.width / fontSize);
  let drops = Array(columns).fill(1);

  function drawMatrixRain() {
    ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = '#39ff14';
    ctx.font = fontSize + 'px monospace';
    for (let i = 0; i < drops.length; i++) {
      const char = String.fromCharCode(0x30A0 + Math.random() * 96);
      ctx.fillText(char, i * fontSize, drops[i] * fontSize);
      if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
        drops[i] = 0;
      }
      drops[i]++;
    }
  }
  setInterval(drawMatrixRain, 80);

  window.addEventListener("resize", () => {
    columns = Math.floor(canvas.width / fontSize);
    drops = Array(columns).fill(1);
  });
  </script>

  <script>
  const terminalContent = document.getElementById('terminal-content');
  const terminalInput = document.getElementById('terminal-input');
  const terminalWrapper = document.getElementById('terminal');
  const terminalSuggestion = document.getElementById('terminal-suggestion');

  function scrollToBottom() {
    terminalWrapper.scrollTo({ top: terminalWrapper.scrollHeight, behavior: 'smooth' });
  }

  // Startup message
  const startupMsg = document.createElement('div');
  startupMsg.style.color = '#b2eaff';
  startupMsg.innerHTML = 'Interactive terminal — type "help" to explore.<br><span style="color:#888; font-size:0.85em;">This terminal explains how I think, what I’ve worked on, and why I’m seeking to transition into your engineering team.</span>';
  terminalContent.appendChild(startupMsg);

  // API endpoint
  const API_URL = 'https://1q5jqzu90k.execute-api.eu-north-1.amazonaws.com/';

  const commandList = [
    'help',
    'whoami',
    'thinking',
    'work',
    'stack',
    'growth',
    'principles',
    'github',
    'linkedin',
    'clear',
    'exit'
  ];

  async function executeCommand(cmd) {
    try {
      const res = await fetch(API_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ command: cmd })
      });
      const data = await res.json();
      
      // Handle response types from backend
      if (data.type === 'redirect') {
        window.open(data.url, '_blank');
        return { type: 'text', body: `Opening ${data.url}...` };
      }
      
      return data;
    } catch (err) {
      console.error(err);
      return { type: 'error', message: 'Error processing command' };
    }
  }

  // Command history
  let commandHistory = [];
  let historyIndex = -1;

  // Tab-completion
  terminalInput.addEventListener('input', function(e) {
    const typedText = document.getElementById('typedText');
    if (typedText) typedText.textContent = terminalInput.value;
    const val = terminalInput.value.trim().toLowerCase();
    if (!val) {
      terminalSuggestion.style.display = 'none';
      return;
    }
    let matches = commandList.filter(cmd => cmd.startsWith(val));
    if (!matches.length) matches = commandList.filter(cmd => cmd.includes(val));
    if (matches.length && matches[0].toLowerCase() !== val) {
      terminalSuggestion.style.display = 'inline';
      terminalSuggestion.textContent = matches[0];
    } else {
      terminalSuggestion.style.display = 'none';
    }
  });

  terminalInput.addEventListener('keydown', function(e) {
    const typedText = document.getElementById('typedText');
    
    // Tab complete
    if (e.key === 'Tab') {
      e.preventDefault();
      const val = terminalInput.value.trim().toLowerCase();
      let matches = commandList.filter(cmd => cmd.startsWith(val));
      if (!matches.length) matches = commandList.filter(cmd => cmd.includes(val));
      if (matches.length) {
        terminalInput.value = matches[0];
        if (typedText) typedText.textContent = terminalInput.value;
        terminalSuggestion.style.display = 'none';
      }
    }

    // History navigation
    if (e.key === 'ArrowUp' || e.key === 'ArrowDown') {
      if (commandHistory.length === 0) return;
      if (e.key === 'ArrowUp') {
        historyIndex = (historyIndex <= 0) ? commandHistory.length - 1 : historyIndex - 1;
      } else {
        historyIndex = (historyIndex >= commandHistory.length - 1) ? 0 : historyIndex + 1;
      }
      terminalInput.value = commandHistory[historyIndex];
      if (typedText) typedText.textContent = terminalInput.value;
      e.preventDefault();
    }
  });

  terminalInput.addEventListener('keydown', async function(e) {
    if (e.key !== 'Enter') return;
    
    const input = terminalInput.value.trim();
    const typedText = document.getElementById('typedText');
    if (typedText) typedText.textContent = '';
    if (!input) return;

    commandHistory.push(input);
    historyIndex = commandHistory.length;

    // Show command in terminal
    const output = document.createElement('div');
    output.innerHTML = `<span style="color:#00ffff;">$</span> <span style="color:#e0f7ff;">${input}</span>`;
    terminalContent.appendChild(output);
    terminalSuggestion.style.display = 'none';

    // Execute command via API
    const resp = await executeCommand(input);
    
    // Handle response types
    if (resp.type === 'clear') {
      terminalContent.innerHTML = '';
    } else if (resp.type === 'text') {
      const response = document.createElement('div');
      response.innerHTML = `<pre>${resp.body}</pre>`;
      terminalContent.appendChild(response);
    } else if (resp.type === 'error') {
      const response = document.createElement('div');
      response.innerHTML = `<pre style="color:#ff6666;">${resp.message}</pre>`;
      terminalContent.appendChild(response);
    }

    terminalInput.value = '';
    scrollToBottom();
  });

  function appendMessage(text, color) {
    const msg = document.createElement('div');
    msg.textContent = text;
    msg.style.color = color;
    terminalContent.appendChild(msg);
  }

  // Focus input on terminal click
  terminalWrapper.addEventListener('click', () => terminalInput.focus());
  
  // Auto-focus on load
  terminalInput.focus();
  </script>
</body>
</html>
